<header class="header">
  <div class="top-header">
    <div class="left">
      <div class="brand">
        <span class="brand-text">SmartBillPro</span>
      </div>

      <div class="search-box">
        <input type="text" placeholder="Search..." />
      </div>
    </div>

    <div class="right" *ngIf="isLoggedIn()">
    
      <div
        class="user-menu"
        [class.open]="userDropdownOpen"
        (click)="toggleUserDropdown($event)"
      >
        <div class="user-info">
          <span class="username">{{ getCurrentUserName() || 'User' | titlecase }}</span>
          <span class="role">{{ getCurrentUserRole() || 'Guest' | titlecase }}</span>
        </div>
        <lucide-angular name="chevron-down" class="dropdown-icon"></lucide-angular>
      </div>

      <ul class="dropdown" *ngIf="userDropdownOpen">
        <li (click)="goToProfile()">
          <lucide-angular name="user"></lucide-angular> Profile
        </li>
        <li (click)="goToSettings()">
          <lucide-angular name="settings"></lucide-angular> Settings
        </li>
        <li (click)="logout()">
          <lucide-angular name="log-out"></lucide-angular> Logout
        </li>
      </ul>
    </div>
  </div>

  <nav class="nav-bar">
    <ul class="nav-list">
      <li
        class="nav-item"
        *ngFor="let item of navItems"
        [class.open]="item.expanded"
        (mouseenter)="onMouseEnter(item)"
        (mouseleave)="onMouseLeave(item)"
      >
        <a [routerLink]="item.route || ''" class="nav-link" routerLinkActive="active">
          <lucide-angular *ngIf="item.icon" [name]="item.icon"></lucide-angular>
          <span>{{ item.label }}</span>
          <lucide-angular
            *ngIf="item.children?.length"
            name="chevron-down"
            class="submenu-icon"
          ></lucide-angular>
        </a>

        <ul *ngIf="item.children?.length" class="submenu" [class.show]="item.expanded">
          <li *ngFor="let sub of item.children">
            <a
              [routerLink]="sub.route || ''"
              class="submenu-link"
              routerLinkActive="active"
            >
              <lucide-angular *ngIf="sub.icon" [name]="sub.icon"></lucide-angular>
              {{ sub.label }}
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>
</header>
