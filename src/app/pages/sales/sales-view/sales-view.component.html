<!-- ===================== SIDEBAR (LEFT) ===================== -->
<div class="sidebar">
  <div class="sidebar-item active">
    <i class="bi bi-lightning-charge-fill"></i>
  </div>

  <div class="sidebar-item">
    <i class="bi bi-grid-fill"></i>
  </div>

  <div class="sidebar-item">
    <i class="bi bi-receipt-cutoff"></i>
  </div>

  <div class="sidebar-item">
    <i class="bi bi-people-fill"></i>
  </div>

  <div class="sidebar-item">
    <i class="bi bi-gear-fill"></i>
  </div>

  <div class="sidebar-item">
    <i class="bi bi-bar-chart-fill"></i>
  </div>
</div>

<!-- ===================== EDITOR PANEL (RIGHT SIDE) ===================== -->
<div class="editor-panel">
  <h2 class="editor-title">Print Settings</h2>
  <p class="editor-subtitle">Configure invoice settings</p>

  <h3 class="section-label">PRINT CONFIGURATION</h3>

  <label>Paper Size</label>
  <select [(ngModel)]="selectedPageSize" (change)="updateSizeInfo()">
    <option value="a4">A4 (Standard)</option>
    <option value="a5">A5</option>
    <option value="a6">A6</option>
    <option value="thermal58">Thermal 58mm</option>
    <option value="thermal80">Thermal 80mm</option>
    <option value="thermal110">Thermal 110mm</option>
  </select>

  <label>Orientation</label>
  <div class="orientation-box">
    <button
      class="orient-btn"
      [class.active]="orientation === 'portrait'"
      (click)="orientation = 'portrait'"
    >
      Portrait
    </button>

    <button
      class="orient-btn"
      *ngIf="!selectedPageSize.includes('thermal')"
      [class.active]="orientation === 'landscape'"
      (click)="orientation = 'landscape'"
    >
      Landscape
    </button>
  </div>

  <h3 class="section-label">INVOICE DETAILS</h3>

  <label>Invoice Number</label>
  <input type="text" [value]="invoice.invoiceNumber" readonly />

  <label>Date</label>
  <input
    type="text"
    [value]="invoice.invoiceDate | date : 'dd-MMM-yyyy'"
    readonly
  />

  <div class="disabled-info">Editing disabled in preview mode</div>

  <button class="print-main-btn" (click)="printInvoice()">
    <i class="bi bi-printer-fill"></i> Print Invoice
  </button>

  <button class="download-main-btn" (click)="downloadPDF()">
    <i class="bi bi-file-earmark-pdf-fill"></i>
    Download Invoice
  </button>
</div>

<!-- ===================== INVOICE PREVIEW AREA ===================== -->
<div class="invoice-wrapper">
  <div
    id="invoicePDF"
    class="invoice-container"
    [ngClass]="[selectedPageSize, orientation]"
  >
    <div class="invoice-header">
      <div class="header-left">
        <h1>SMARTBILLPRO</h1>
        <h3>Manufacturing & Supply of Precision Press Tool & Room Component</h3>
      </div>

      <div class="header-right">
        <img src="assets/logos/smartbilllogo.png" alt="SmartBillPro Logo" />
      </div>
    </div>

    <table class="header-table">
      <tbody>
        <tr>
          <td>
            {{ company.addressLine1 }}<br />
            {{ company.addressLine2 }}<br />
            {{ company.addressLine3 }} {{ company.addressLine4 }}<br />
            {{ company.city }}, {{ company.state }} - {{ company.pincode }}
          </td>
          <td>
            Phone: {{ company.phone }}<br />
            Web: {{ company.website }}<br />
            Email: {{ company.email }}
          </td>
        </tr>
      </tbody>
    </table>

    <div class="pan-row">
      <span><strong>PAN :</strong> {{ company.panNumber }}</span>
      <span class="invoice-title">TAX INVOICE</span>
      <span class="right">ORIGINAL FOR RECIPIENT</span>
    </div>

    <!-- ===== CUSTOMER DETAILS ===== -->
    <table class="details-grid">
      <tbody>
        <tr>
          <td>
            <strong>Customer Details</strong><br />
            <strong>Name:</strong> {{ invoice.customerName }}<br />
            <strong>Address:</strong> {{ invoice.customerAddress }}<br />
            <strong>Phone:</strong> {{ invoice.customerContact }}<br />
            <strong>GSTIN:</strong> {{ invoice.customerGSTIN }}<br />
            <strong>Place of Supply:</strong> {{ invoice.placeOfSupply }}
          </td>

          <td>
            <strong>Invoice No:</strong> {{ invoice.invoiceNumber }}<br />
            <strong>Invoice Date:</strong>
            {{ invoice.invoiceDate | date : "dd-MMM-yyyy" }}<br />
            <strong>Challan No:</strong> {{ invoice.challanNo }}<br />
            <strong>Challan Date:</strong>
            {{ invoice.challanDate | date : "dd-MMM-yyyy" }}<br />
            <strong>E-Way Bill No:</strong> {{ invoice.ewayBill }}<br />
            <strong>Transport:</strong> {{ invoice.transportName }}<br />
            <strong>Transport ID:</strong> {{ invoice.transportGst }}
          </td>
        </tr>
      </tbody>
    </table>

    <!-- ===== ITEM TABLE ===== -->
    <table class="items-table">
      <thead>
        <tr>
          <th>Sr. No.</th>
          <th>Name of Product / Service</th>
          <th>HSN / SAC</th>
          <th>Qty</th>
          <th>Rate</th>
          <th>Taxable Value</th>
          <th>GST %</th>
          <th>GST Amount</th>
          <th>Total</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of invoice.items; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ item.productName }}</td>
          <td>{{ item.hsnid }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.saleRate | number : "1.2-2" }}</td>
          <td>{{ item.taxableAmount | number : "1.2-2" }}</td>
          <td>{{ item.gstPercentage }}%</td>
          <td>{{ item.gstAmount | number : "1.2-2" }}</td>
          <td>{{ item.netAmount | number : "1.2-2" }}</td>
        </tr>
      </tbody>

      <tfoot>
        <tr>
          <td colspan="3" class="center bold">Total</td>
          <td>{{ invoice.totalQty }}</td>
          <td></td>
          <td>{{ invoice.totalTaxableAmount | number : "1.2-2" }}</td>
          <td></td>
          <td>{{ invoice.totalGstAmount | number : "1.2-2" }}</td>
          <td>{{ invoice.totalInvoiceAmount | number : "1.2-2" }}</td>
        </tr>
      </tfoot>
    </table>

    <div class="words-box">
      <strong>Total in words:</strong> {{ invoice.amountInWords }}
    </div>

    <div class="summary-wrapper">
      <!-- RIGHT : PAYMENT SUMMARY -->
      <table class="summary-table payment-table">
        <tbody>
          <tr>
            <td>Cash</td>
            <td>₹ {{ invoice.cash | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>Card</td>
            <td>₹ {{ invoice.card | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>UPI</td>
            <td>₹ {{ invoice.upi | number : "1.2-2" }}</td>
          </tr>

          <tr class="total-row">
            <td>Total Paid</td>
            <td>₹ {{ invoice.totalPaid | number : "1.2-2" }}</td>
          </tr>

          <tr>
            <td>Balance</td>
            <td>₹ {{ invoice.balance | number : "1.2-2" }}</td>
          </tr>
        </tbody>
      </table>

      <!-- LEFT : AMOUNT / TAX SUMMARY -->
      <table class="summary-table">
        <tbody>
          <tr>
            <td>Total Quantity</td>
            <td>{{ invoice.totalQuantity }}</td>
          </tr>
          <tr>
            <td>Gross Amount</td>
            <td>₹ {{ invoice.totalGrossAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>Discount</td>
            <td>₹ {{ invoice.totalDiscAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>Taxable Amount</td>
            <td>₹ {{ invoice.totalTaxableAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>CGST</td>
            <td>₹ {{ invoice.totalCGSTAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>SGST</td>
            <td>₹ {{ invoice.totalSGSTAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>IGST</td>
            <td>₹ {{ invoice.totalIGSTAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>Total GST</td>
            <td>₹ {{ invoice.totalGstAmount | number : "1.2-2" }}</td>
          </tr>
          <tr>
            <td>Round Off</td>
            <td>₹ {{ invoice.totalRoundOff | number : "1.2-2" }}</td>
          </tr>

          <tr class="total-row">
            <td>Grand Total</td>
            <td>₹ {{ invoice.totalInvoiceAmount | number : "1.2-2" }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <table class="bank-terms-table">
      <tbody>
        <tr>
          <td class="bank-cell">
            <strong>Bank Details</strong><br />
            Bank: {{ company.bankName }}<br />
            Branch: {{ company.bankBranch }}<br />
            A/c No: {{ company.bankAccountNumber }}<br />
            IFSC: {{ company.ifscCode }}<br />
            UPI ID: {{ company.upiId }}
          </td>

          <td class="terms-cell">
            <strong>Terms and Conditions</strong><br />
            Subject to Maharashtra Jurisdiction.<br />
            Goods once sold will not be taken back.<br />
            Delivery Ex-Premises.
          </td>
        </tr>

        <tr>
          <td class="sign-cell">Customer Signature: ___________________</td>

          <!-- THANK YOU -->
          <td class="thanks-cell">Thank you for shopping with us!</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Bootstrap Icons -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
/>
