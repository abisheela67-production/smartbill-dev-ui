<header class="pos-header">
  <!-- LEFT AREA -->
  <div class="header-left">
    <!-- Bag Icon -->
    <div class="icon-btn">
      <i class="ri-shopping-bag-3-line"></i>
    </div>

    <!-- Company Dropdown -->
    <select
      [(ngModel)]="selectedCompanyId"
      (ngModelChange)="onCompanyChange($event)"
      appFocusOnKey
      targetId="companyName"
      [autoFocus]="true"
    >
      <option *ngFor="let c of companies" [value]="c.companyID">
        {{ c.companyName }}
      </option>
    </select>

    <select [(ngModel)]="selectedBranchId" appFocusOnKey targetId="branchName">
      <option [ngValue]="null">-- Select Branch --</option>
      <option *ngFor="let b of branches" [value]="b.branchID">
        {{ b.branchName }}
        
      </option>
    </select>
  </div>

  <!-- CENTER SEARCH BAR -->
  <div class="header-center">SmartBillPro</div>

  <!-- RIGHT CONTROLS -->
  <div class="header-right">
    <!-- Hotkey Button -->
    <div class="segmented">
      <div class="segmented">
        <button [class.active]="billMode === 'POS'" (click)="billMode = 'POS'">
          POS MODE
        </button>

        <button
          [class.active]="billMode === 'HOTKEY'"
          (click)="billMode = 'HOTKEY'"
        >
          HOTKEY MODE
        </button>
      </div>
    </div>
  </div>
</header>

<div class="pos-wrapper">
  <div class="pos-left">
    <div class="billing-gst-row">
      <!-- BUSINESS TYPE -->
      <div class="radio-card">
        <div class="card-title">Business Type</div>

        <div class="radio-group">
          <label class="radio-item" *ngFor="let bt of businessTypes">
            <input
              type="radio"
              name="businessType"
              [value]="bt"
              [(ngModel)]="selectedBusinessType"
              (change)="onBusinessTypeChanged()"
            />
            <span>{{ bt.businessTypeName }}</span>
          </label>
        </div>
      </div>

      <!-- GST TYPE -->
      <div class="radio-card">
        <div class="card-title">GST Type</div>

        <div class="radio-group">
          <label class="radio-item" *ngFor="let gst of gstTypesList">
            <input
              type="radio"
              name="gstType"
              [value]="gst"
              [(ngModel)]="selectedGstType"
            />
            <span>{{ gst.transactionTypeName }}</span>
          </label>
        </div>
      </div>
      <!-- Invoice No -->
      <div class="form-field">
        <label>Invoice Date</label>
        <input
          type="date"
          [(ngModel)]="selectedInvoiceDate"
          appFocusOnKey
          targetId="invoiceDate"
        />
      </div>
    </div>

    <!-- Product List Table -->
    <div class="product-table">
      <div class="popup-grid" *ngIf="smallGridVisible">
        <app-small-grid
          [columns]="productGridColumns"
          [data]="smallGridData"
           (rowSelected)="onProductSelected($event)"
        ></app-small-grid>
      </div>
      <div class="big-grid">
        <app-input-data-grid
          [columns]="visibleColumns"
          [data]="salesEntries"
          (numberChanged)="onGridNumberChanged($event)"
          (rowAdded)="onGridRowAdded($event)"
          [parent]="{
            branches: branches,
            companies: companies,
            categories: categories,
            subCategories: subCategories,
            brands: brands,
            units: units,
            hsnCodes: hsnCodes,
            taxes: taxes,
            cesses: cesses,
            suppliers: suppliers,
            statuses: statuses,
            showSmallGrid: showSmallGrid.bind(this)
          }"
          selectionMode="FullRowSelect"
          [allowUserToAddRows]="true"
          [allowUserToDeleteRows]="true"
          [allowUserToResizeColumns]="true"
        ></app-input-data-grid>
      </div>
    </div>
  </div>

  <!-- RIGHT SIDE -->
  <div class="pos-right">
    <!-- BILL TABS -->
    <div class="bill-tabs">
      <!-- ACTIVE BILL BUTTONS -->
      <button
        *ngFor="let tab of billTabs; let i = index"
        [class.active]="activeBillIndex === i"
        (click)="switchBill(i)"
      >
        {{ tab.name }}
      </button>

      <!-- ADD NEW BILL -->
      <button class="add-tab" (click)="nextBill()">+</button>
    </div>

    <!-- BILLING OPTIONS CARD -->
    <div class="billing-card">
      <div class="customer-row">
        <label>Customer</label>
        <select>
          <option>Walk-in Customer -</option>
        </select>

        <label>Customer GSTIN</label>
        <input type="text" placeholder="Optional" />
      </div>
    </div>

    <!-- CART SECTION -->
    <div class="cart-section">
      <table>
        <thead>
          <tr>
            <th>Product</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Total</th>
          </tr>
        </thead>
      </table>
    </div>

    <!-- TOTALS -->
    <div class="bill-summary">
      <div class="row"><span>Gross Amt:</span> <span>0.00</span></div>
      <div class="row discount"><span>Discount:</span> <span>- 0.00</span></div>
      <div class="row"><span>Taxable Amt:</span> <span>0.00</span></div>
      <div class="row"><span>GST:</span> <span>+ 0.00</span></div>
    </div>

    <!-- INVOICE TOTAL -->
    <h2 class="invoice-total">INVOICE TOTAL <span>₹0.00</span></h2>

    <!-- ACTION BUTTONS -->
    <div class="action-buttons">
      <button class="hold-btn">⏱ HOLD</button>

      <button class="complete-sale-btn">✓ COMPLETE SALE</button>
    </div>
  </div>
</div>
