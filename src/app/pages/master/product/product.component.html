<app-group-box title="Product Details">
 <div class="action-buttons">
      <button class="btn btn-primary btn-elevated" (click)="downloadTemplate()">
        Download Product Template
      </button>
      <button class="btn btn-success btn-elevated" (click)="addNewProduct()">
        Add Product
      </button>

<button>
  
        <input
          type="file"
          id="fileInput"
          (change)="uploadExcel($event)"
          style="display: none"
        />
        <label for="fileInput" class="btn btn-info btn-elevated"
          >Upload Products</label
        >
</button>

<!-- ðŸ”¹ Spinner overlay -->
<div class="upload-spinner" *ngIf="isUploading">
  <div class="spinner"></div>
  <p>Uploading and processing Excel...</p>
</div>


      <button class="btn btn-secondary" (click)="saveAllProducts()">
        Save
      </button>
    </div>

<div class="product-management">


  <div class="data-grid-section">
    <app-input-data-grid
      [columns]="visibleColumns"
      [data]="products"
      [parent]="{
        companies: companies,
        categories: categories,
        subCategories: subCategories,
        brands: brands,
        units: units,
        hsnCodes: hsnCodes,
        taxes: taxes,
        cesses: cesses
      }"
      selectionMode="FullRowSelect"
      [allowUserToAddRows]="true"
      [allowUserToDeleteRows]="true"
      [allowUserToResizeColumns]="true"
      (cellValueChanged)="onCellValueChanged($event)"
    ></app-input-data-grid>
  </div>
</div>


</app-group-box>
